apiVersion: x.symphony.k8s.aws/v1alpha1
kind: Abstraction
metadata:
  name: simples3var.x.symphony.k8s.aws
spec:
  apiVersion: v1alpha1
  kind: SimpleS3Var
  definition:
    spec:
      name: string
      crName: string
      numberTags: int

  celOptions:
    define:
    - defaultAnnotations:
        key: value
    - name: tags
      definition:
        key: key_${i%2 == 0}
        value: value${i+10}${pod.status.conditions[0]}
  resources:
  - name: my-var-bucket
    definition:
      apiVersion: s3.services.k8s.aws/v1alpha1
      kind: Bucket
      metadata:
        name: "${spec.crName}"
      spec:
        name: "${spec.name}"
  - name: my-var-bucket-2
    manageOn: ${spec.createBucket2}
    definition:
      apiVersion: s3.services.k8s.aws/v1alpha1
      kind: Bucket
      metadata:
        name: ack-${injectRandomPrefix(spec.crName)}-2
      spec:
        name: ${spec.name}-2
        tags: []